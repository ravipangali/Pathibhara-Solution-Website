{% extends 'frontend/layouts/base.html' %}

{% block extra_css %}
  <style>
    /* Project Detail Page Styles */
    .project-header {
      background: linear-gradient(to right, rgba(255, 255, 255, 0.9), rgba(230, 249, 243, 0.8)), url('/media/hero/project-detail-bg.jpg');
      background-size: cover;
      background-position: center;
      padding: 120px 0 80px;
      position: relative;
    }
    
    .breadcrumb-item a {
      color: var(--primary-color);
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .breadcrumb-item a:hover {
      color: var(--primary-dark);
    }
    
    .project-gallery {
      position: relative;
      margin-bottom: 40px;
    }
    
    .main-image-container {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      position: relative;
      height: 500px;
    }
    
    .main-image-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
    
    .main-image-container:hover img {
      transform: scale(1.03);
    }
    
    .thumbnail-container {
      display: flex;
      gap: 15px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    
    .thumbnail {
      width: 120px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .thumbnail.active {
      border-color: var(--primary-color);
      transform: translateY(-5px);
    }
    
    .thumbnail:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    
    .project-meta {
      background-color: #f9f9f9;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      height: 100%;
    }
    
    .meta-item {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    
    .meta-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    
    .meta-title {
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 5px;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .meta-content {
      color: var(--text-color);
      font-size: 16px;
    }
    
    .project-content {
      line-height: 1.8;
      color: var(--text-color);
    }
    
    .project-content h2,
    .project-content h3 {
      margin-top: 30px;
      margin-bottom: 20px;
      color: var(--text-dark);
    }
    
    .project-content p {
      margin-bottom: 20px;
    }
    
    .project-content img {
      max-width: 100%;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .related-project-card {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
      transition: all 0.4s ease;
      height: 100%;
      background-color: white;
    }
    
    .related-project-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(46, 125, 50, 0.1);
    }
    
    .related-project-image {
      height: 220px;
      overflow: hidden;
    }
    
    .related-project-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.6s ease;
    }
    
    .related-project-card:hover .related-project-image img {
      transform: scale(1.1);
    }
    
    .related-project-content {
      padding: 25px;
    }
    
    .related-project-content h4 {
      font-size: 20px;
      margin-bottom: 12px;
      font-weight: 600;
    }
    
    .related-project-content p {
      color: var(--text-light);
      margin-bottom: 15px;
      line-height: 1.6;
    }
    
    .btn-outline {
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      background: transparent;
      padding: 8px 20px;
      border-radius: 30px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .btn-outline:hover {
      background: var(--primary-color);
      color: white;
    }
    
    .cta-section {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);
      border-radius: 12px;
      padding: 60px;
      margin-top: 80px;
    }
    
    @media (max-width: 991px) {
      .project-meta {
        margin-top: 40px;
      }
    
      .cta-section {
        padding: 40px;
      }
    }
    
    @media (max-width: 767.98px) {
      .main-image-container {
        height: 350px;
      }
    
      .thumbnail {
        width: 100px;
        height: 70px;
      }
    
      .related-project-image {
        height: 180px;
      }
    
      .cta-section {
        padding: 30px;
        text-align: center;
      }
    
      .cta-section .btn {
        margin-top: 20px;
      }
    }
  </style>
{% endblock %}

{% block content %}
  <!-- Project Header -->
  <section class="project-header">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="/">Home</a>
          </li>
          <li class="breadcrumb-item">
            <a href="/projects">Projects</a>
          </li>
          <li class="breadcrumb-item active">
            {% if project %}
              {{ project.name }}
            {% else %}
              E-commerce Website
            {% endif %}
          </li>
        </ol>
      </nav>

      <h1 class="display-4 fw-bold mt-4 mb-2">
        {% if project %}
          {{ project.name }}
        {% else %}
          E-commerce Website
        {% endif %}
      </h1>

      <p class="lead text-muted">
        {% if project.category %}
          {{ project.category }}
        {% else %}
          Web Development
        {% endif %}
      </p>
    </div>
  </section>

  <!-- Project Details Section -->
  <section class="section-padding">
    <div class="container">
      <div class="row g-5">
        <!-- Project Gallery and Content -->
        <div class="col-lg-8 animate-on-scroll">
          <!-- Project Gallery -->
          <div class="project-gallery">
            <div class="main-image-container">
              {% if project.image %}
                <img id="mainProjectImage" src="{{ project.image.url }}" alt="{{ project.name }}" class="img-fluid" />
              {% else %}
                <img id="mainProjectImage" src="https://via.placeholder.com/1200x600" alt="Project Image" class="img-fluid" />
              {% endif %}
            </div>

            {% if project_images %}
              <div class="thumbnail-container">
                <!-- First thumbnail for main image -->
                <div class="thumbnail active"
                  onclick="changeMainImage('{% if project.image %}
                    {{ project.image.url }}
                  {% else %}
                    https://via.placeholder.com/1200x600
                  {% endif %}', this)">
                  {% if project.image %}
                    <img src="{{ project.image.url }}" alt="{{ project.name }}" />
                  {% else %}
                    <img src="https://via.placeholder.com/1200x600" alt="Project Image" />
                  {% endif %}
                </div>

                {% for image in project_images %}
                  <div class="thumbnail" onclick="changeMainImage('{{ image.image.url }}', this)">
                    <img src="{{ image.image.url }}" alt="{{ project.name }}" />
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>

          <!-- Project Content -->
          <div class="project-content mt-5">
            <h2>Project Overview</h2>

            {% if project.description %}
              {{ project.description|safe }}
            {% else %}
              <p>This comprehensive e-commerce platform was designed to provide a seamless shopping experience for customers while giving business owners powerful tools to manage their online store. The platform includes advanced product management, inventory tracking, secure payment processing, and customer relationship management.</p>

              <h3>Key Features</h3>
              <ul>
                <li>Responsive design for optimal viewing on all devices</li>
                <li>Advanced product filtering and search functionality</li>
                <li>Secure payment gateway integration</li>
                <li>Customer account management</li>
                <li>Order tracking and history</li>
                <li>Admin dashboard with comprehensive analytics</li>
                <li>Inventory management system</li>
                <li>Marketing tools including discount codes and promotions</li>
              </ul>

              <p>The platform was built using the latest web technologies to ensure optimal performance, security, and scalability. The client has reported a 45% increase in online sales since launching the new website.</p>
            {% endif %}
          </div>
        </div>

        <!-- Project Meta Information -->
        <div class="col-lg-4 animate-on-scroll">
          <div class="project-meta">
            <div class="meta-item">
              <div class="meta-title">Client</div>
              <div class="meta-content">
                {% if project.client %}
                  {{ project.client }}
                {% else %}
                  Fashion Retailer Inc.
                {% endif %}
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-title">Project Date</div>
              <div class="meta-content">
                {% if project.completion_date %}
                  {{ project.completion_date }}
                {% else %}
                  June 2023
                {% endif %}
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-title">Category</div>
              <div class="meta-content">
                {% if project.category %}
                  {{ project.category }}
                {% else %}
                  Web Development, E-commerce
                {% endif %}
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-title">Technologies</div>
              <div class="meta-content">
                {% if project.technologies %}
                  {{ project.technologies }}
                {% else %}
                  Django, Python, JavaScript, HTML5, CSS3, PostgreSQL
                {% endif %}
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-title">Project URL</div>
              <div class="meta-content">
                {% if project.demo_url %}
                  <a href="{{ project.demo_url }}" target="_blank" rel="noopener noreferrer">{{ project.demo_url }}</a>
                {% else %}
                  <a href="#" target="_blank">www.fashionretailer.com</a>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Projects Section -->
  <section class="section-padding bg-light">
    <div class="container">
      <div class="section-title text-center animate-on-scroll mb-5">
        <h2 class="mb-2">Related Projects</h2>
        <p class="lead text-muted"> {% if related_projects %} Explore more of our work in similar categories {% else %} No related projects found {% endif %}</p>
      </div>

      <div class="row g-4">
        {% for related in related_projects %}
          <div class="col-lg-4 col-md-6 animate-on-scroll">
            <div class="related-project-card">
              <div class="related-project-image">
                {% if related.image %}
                  <img src="{{ related.image.url }}" alt="{{ related.title }}" />
                {% else %}
                  <img src="https://via.placeholder.com/600x400" alt="{{ related.title }}" />
                {% endif %}
              </div>
              <div class="related-project-content">
                <h4>{{ related.title }}</h4>
                <p>{{ related.description|striptags|truncatechars:100 }}</p>
                <a href="/projects/{{ related.id }}" class="btn btn-outline mt-2">View Project</a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- CTA Section -->
      <div class="cta-section animate-on-scroll">
        <div class="row align-items-center">
          <div class="col-lg-8">
            <h2 class="text-white mb-3">Have a similar project in mind?</h2>
            <p class="text-white opacity-90 mb-0">Let's discuss how we can bring your vision to life with our expertise.</p>
          </div>
          <div class="col-lg-4 text-lg-end">
            <a href="/contact" class="btn btn-light btn-lg px-4">Get in Touch</a>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock %}

{% block extra_js %}
  <script>
    // Function to change the main project image
    function changeMainImage(imageUrl, thumbElement) {
      // Update main image with fade effect
      const mainImage = document.getElementById('mainProjectImage')
      mainImage.style.opacity = '0.5'
    
      setTimeout(() => {
        mainImage.src = imageUrl
        mainImage.style.opacity = '1'
      }, 200)
    
      // Update active thumbnail
      const thumbnails = document.querySelectorAll('.thumbnail')
      thumbnails.forEach((thumb) => {
        thumb.classList.remove('active')
      })
    
      thumbElement.classList.add('active')
    }
    
    // Animation for elements on scroll
    document.addEventListener('DOMContentLoaded', function () {
      const animateElements = document.querySelectorAll('.animate-on-scroll')
    
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animated', 'fadeInUp')
              observer.unobserve(entry.target)
            }
          })
        },
        {
          threshold: 0.1
        }
      )
    
      animateElements.forEach((element) => {
        observer.observe(element)
      })
    })
  </script>
{% endblock %}
